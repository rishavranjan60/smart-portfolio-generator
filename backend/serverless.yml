org: rishavai
service: smart-portfolio-api

provider:
  name: aws
  runtime: python3.11
  region: eu-central-1
  timeout: 29
  memorySize: 512
  stage: dev
  environment:
    GOOGLE_API_KEY: ${env:GOOGLE_API_KEY}  # ✅ Load Gemini API key from .env

functions:
  app:
    handler: main.handler
    events:
      - httpApi:
          path: /{proxy+}
          method: '*'

plugins:
  - serverless-python-requirements
  - serverless-dotenv-plugin  # ✅ Load .env file automatically

custom:
  pythonRequirements:
    dockerizePip: true
    slim: true
    strip: true
    useStaticCache: false
    useDownloadCache: false
    noDeploy:
      - pip
      - setuptools
      - wheel

package:
  individually: true
  exclude:
    - venv/**
    - .venv/**
    - node_modules/**
    - __pycache__/**
    - .pytest_cache/**
    - .serverless/**
    - .DS_Store
    - '*.zip'
    - frontend/**
    - .env
